<view class="home-page">
  <!-- æœªç™»å½•çŠ¶æ€ -->
  <block wx:if="{{!isLoggedIn}}">
    <view class="welcome-section full-height">
      <view class="welcome-bg"></view>
      <view class="welcome-content">
        <text class="welcome-icon">ğŸ“</text>
        <text class="welcome-title">æ ¡ä¹’ç½‘</text>
        <text class="welcome-subtitle">æ ¡å›­ä¹’ä¹“çƒçˆ±å¥½è€…ç¤¾åŒº</text>
        <text class="welcome-desc">çº¦çƒã€èµ›äº‹ã€æ’è¡Œã€ç­¾åˆ°ï¼Œä¸€ç«™æå®š</text>
        <button class="login-btn" bindtap="onTapLogin">å¾®ä¿¡ç™»å½•</button>
      </view>
    </view>
  </block>

  <!-- å·²ç™»å½•çŠ¶æ€ -->
  <block wx:else>
    <!-- ç”¨æˆ·ä¿¡æ¯å¤´éƒ¨ -->
    <view class="user-header">
      <view class="header-bg"></view>
      <view class="header-content">
        <view class="user-info">
          <image
            class="avatar"
            src="{{userInfo.avatar_url || '/images/default-avatar.png'}}"
            mode="aspectFill"
          />
          <view class="user-text">
            <text class="greeting">Hiï¼Œ{{userInfo.name || 'çƒå‹'}}</text>
            <text class="user-school" wx:if="{{userInfo.school_name}}">{{userInfo.school_name}}</text>
          </view>
        </view>

        <!-- æœªå®Œå–„ä¿¡æ¯æç¤º -->
        <view class="complete-tip" wx:if="{{!isRegistered}}" bindtap="goToRegister">
          <text class="tip-text">å®Œå–„ä¸ªäººä¿¡æ¯ï¼Œè§£é”å…¨éƒ¨åŠŸèƒ½</text>
          <text class="tip-arrow">â†’</text>
        </view>
      </view>
    </view>

    <!-- å¿«æ·å…¥å£ -->
    <view class="quick-section">
      <view class="quick-grid">
        <view
          wx:for="{{quickActions}}"
          wx:key="label"
          class="quick-item"
          data-url="{{item.url}}"
          bindtap="onTapAction"
        >
          <text class="quick-icon">{{item.icon}}</text>
          <text class="quick-label">{{item.label}}</text>
          <text class="quick-desc">{{item.desc}}</text>
        </view>
      </view>
    </view>

    <!-- æˆ‘çš„æ•°æ® -->
    <view class="stats-section" wx:if="{{isRegistered}}">
      <view class="section-title">æˆ‘çš„æ•°æ®</view>
      <view class="stats-grid">
        <view class="stat-item">
          <text class="stat-value">{{stats.matches}}</text>
          <text class="stat-label">æ€»åœºæ¬¡</text>
        </view>
        <view class="stat-item">
          <text class="stat-value">{{stats.wins}}</text>
          <text class="stat-label">èƒœåˆ©</text>
        </view>
        <view class="stat-item">
          <text class="stat-value">{{stats.events}}</text>
          <text class="stat-label">èµ›äº‹</text>
        </view>
        <view class="stat-item">
          <text class="stat-value">{{stats.checkins}}</text>
          <text class="stat-label">ç­¾åˆ°</text>
        </view>
      </view>
    </view>

    <!-- æœ€è¿‘èµ›äº‹ -->
    <view class="events-section">
      <view class="section-header">
        <text class="section-title">æœ€è¿‘èµ›äº‹</text>
        <text class="section-more">æŸ¥çœ‹æ›´å¤š ></text>
      </view>
      <view class="event-list">
        <view
          wx:for="{{recentEvents}}"
          wx:key="id"
          class="event-item"
          data-id="{{item.id}}"
          bindtap="onTapEvent"
        >
          <view class="event-info">
            <text class="event-title">{{item.title}}</text>
            <text class="event-date">{{item.date}}</text>
          </view>
          <view class="event-status {{item.statusColor}}">{{item.status}}</view>
        </view>
      </view>
    </view>
  </block>

  <!-- éšç§æ”¿ç­–å¼¹çª— -->
  <privacy-modal
    show="{{showPrivacyModal}}"
    bind:agree="onAgreePrivacy"
    bind:disagree="onDisagreePrivacy"
  />
</view>
