<view class="learning-page">
  <!-- Tabæ  -->
  <view class="tabs">
    <view
      wx:for="{{tabs}}"
      wx:key="key"
      class="tab {{currentTab === item.key ? 'active' : ''}}"
      bindtap="onSwitchTab"
      data-tab="{{item.key}}"
    >{{item.label}}</view>
  </view>

  <!-- èµ„æ–™åˆ—è¡¨ -->
  <scroll-view
    class="material-list"
    scroll-y
    bindscrolltolower="onLoadMore"
  >
    <!-- è§†é¢‘åˆ—è¡¨ -->
    <block wx:if="{{currentTab === 'video'}}">
      <view
        class="video-card"
        wx:for="{{materials}}"
        wx:key="id"
        bindtap="onTapMaterial"
        data-id="{{item.id}}"
        data-type="video"
        data-url="{{item.url}}"
      >
        <view class="video-cover">
          <view class="play-btn">â–¶ï¸</view>
          <view class="video-duration" wx:if="{{item.duration}}">{{item.duration}}</view>
        </view>
        <view class="video-info">
          <text class="video-title">{{item.title}}</text>
          <text class="video-meta">{{item.author || 'æœªçŸ¥'}} Â· {{item.view_label}}æ¬¡è§‚çœ‹</text>
        </view>
      </view>
    </block>

    <!-- PPT/æ–‡æ¡£åˆ—è¡¨ -->
    <block wx:else>
      <view
        class="doc-card"
        wx:for="{{materials}}"
        wx:key="id"
        bindtap="onTapMaterial"
        data-id="{{item.id}}"
        data-type="{{item.type}}"
        data-url="{{item.url}}"
      >
        <view class="doc-icon">{{currentTab === 'ppt' ? 'ğŸ“Š' : 'ğŸ“„'}}</view>
        <view class="doc-info">
          <text class="doc-title">{{item.title}}</text>
          <text class="doc-meta">{{item.author || 'æœªçŸ¥'}} Â· {{item.view_label}}æ¬¡æŸ¥çœ‹</text>
        </view>
        <view class="doc-arrow">â€º</view>
      </view>
    </block>

    <view class="loading" wx:if="{{isLoading}}">åŠ è½½ä¸­...</view>
    <view class="no-more" wx:if="{{noMore && materials.length > 0}}">æ²¡æœ‰æ›´å¤šäº†</view>
    <view class="empty" wx:if="{{!isLoading && materials.length === 0}}">
      <text class="empty-icon">ğŸ“š</text>
      <text class="empty-text">æš‚æ— {{currentTab === 'video' ? 'è§†é¢‘' : (currentTab === 'ppt' ? 'PPT' : 'æ–‡æ¡£')}}èµ„æ–™</text>
    </view>
  </scroll-view>
</view>
