<view class="detail-page">
  <view class="post-card" wx:if="{{post}}">
    <view class="post-header">
      <image class="author-avatar" src="{{post.author_avatar || '/images/default-avatar.png'}}" bindtap="onTapUserAvatar" data-id="{{post.author_id}}" />
      <view class="author-info">
        <text class="author-name">{{post.author_name}}</text>
        <text class="post-time">{{post.time_label}}</text>
      </view>
    </view>

    <text class="post-content">{{post.content}}</text>

    <view class="post-images {{post.images.length === 1 ? 'single' : (post.images.length <= 4 ? 'grid-2' : 'grid-3')}}" wx:if="{{post.images.length > 0}}">
      <image
        wx:for="{{post.images}}"
        wx:key="*this"
        class="post-image"
        src="{{item}}"
        mode="aspectFill"
        bindtap="onPreviewImage"
        data-current="{{item}}"
      />
    </view>

    <view class="post-stats">
      <view class="stat-item" bindtap="onTapLike">
        <text class="stat-icon {{post.is_liked ? 'liked' : ''}}">{{post.is_liked ? 'â¤ï¸' : 'ğŸ¤'}}</text>
        <text>{{post.like_count}}</text>
      </view>
      <view class="stat-item">
        <text class="stat-icon">ğŸ’¬</text>
        <text>{{comments.length}}</text>
      </view>
    </view>
  </view>

  <view class="comments-section">
    <view class="section-title">è¯„è®º ({{comments.length}})</view>
    <view class="comment-list">
      <view class="comment-item" wx:for="{{comments}}" wx:key="id">
        <image class="comment-avatar" src="{{item.author_avatar || '/images/default-avatar.png'}}" bindtap="onTapUserAvatar" data-id="{{item.author_id}}" />
        <view class="comment-body">
          <view class="comment-header">
            <text class="comment-author">{{item.author_name}}</text>
            <text class="comment-time">{{item.time_label}}</text>
          </view>
          <text class="comment-content">{{item.content}}</text>
        </view>
      </view>
      <view class="empty-comments" wx:if="{{comments.length === 0}}">
        <text>è¿˜æ²¡æœ‰è¯„è®ºï¼Œå¿«æ¥è¯´ä¸¤å¥å§</text>
      </view>
    </view>
  </view>

  <view class="comment-input-bar" style="bottom: {{keyboardHeight}}px;">
    <input class="comment-input" placeholder="å†™è¯„è®º..." bindinput="onCommentInput" value="{{commentText}}" confirm-type="send" bindconfirm="onSendComment" adjust-position="{{false}}" bindkeyboardheightchange="onKeyboardChange" />
    <button class="send-btn" bindtap="onSendComment" disabled="{{!commentText}}">å‘é€</button>
  </view>
</view>
