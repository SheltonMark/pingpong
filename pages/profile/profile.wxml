<view class="profile-page">
  <!-- å¤´éƒ¨åŒºåŸŸï¼ˆåŒ…å«ç”¨æˆ·ä¿¡æ¯å’Œç»Ÿè®¡å¡ç‰‡ï¼‰ -->
  <view class="header-wrapper">
    <!-- æ©™è‰²èƒŒæ™¯ -->
    <view class="header-bg"></view>

    <!-- ç”¨æˆ·ä¿¡æ¯ -->
    <view class="header-content">
      <!-- æœªç™»å½• -->
      <block wx:if="{{!isLoggedIn}}">
        <view class="avatar-placeholder" bindtap="goToLogin">
          <text class="avatar-icon">ğŸ‘¤</text>
        </view>
        <view class="user-text">
          <text class="login-text" bindtap="goToLogin">ç‚¹å‡»ç™»å½•</text>
        </view>
      </block>

      <!-- å·²ç™»å½• -->
      <block wx:else>
        <image
          class="avatar"
          src="{{userInfo.avatar_url || '/images/default-avatar.png'}}"
          mode="aspectFill"
        />
        <view class="user-text">
          <text class="user-name">{{userInfo.name || 'æœªè®¾ç½®æ˜µç§°'}}</text>
          <text class="user-college" wx:if="{{isRegistered}}">{{userInfo.college_name || userInfo.school_name}} Â· {{userTypeLabel}}</text>
          <view class="complete-btn" wx:if="{{!isRegistered}}" bindtap="goToRegister">
            å®Œå–„ä¸ªäººä¿¡æ¯ â†’
          </view>
        </view>
      </block>
    </view>

    <!-- æ•°æ®ç»Ÿè®¡å¡ç‰‡ï¼ˆå åœ¨æ©™è‰²èƒŒæ™¯ä¸Šï¼‰ -->
    <view class="stats-card" wx:if="{{isRegistered}}">
      <view class="stat-item">
        <text class="stat-value orange">{{stats.score}}</text>
        <text class="stat-label">ç§¯åˆ†</text>
      </view>
      <view class="stat-divider"></view>
      <view class="stat-item">
        <text class="stat-value">#{{stats.rank}}</text>
        <text class="stat-label">æ’å</text>
      </view>
      <view class="stat-divider"></view>
      <view class="stat-item">
        <text class="stat-value">{{stats.winRate}}%</text>
        <text class="stat-label">èƒœç‡</text>
      </view>
    </view>
  </view>

  <!-- èœå•åˆ—è¡¨ -->
  <view class="menu-section">
    <view
      wx:for="{{menuItems}}"
      wx:key="label"
      class="menu-item"
      data-url="{{item.url}}"
      bindtap="onTapMenu"
    >
      <image class="menu-icon-img" src="{{item.iconUrl}}" mode="aspectFit" wx:if="{{item.iconUrl}}" />
      <text class="menu-icon" wx:else>{{item.icon}}</text>
      <text class="menu-label">{{item.label}}</text>
      <view class="menu-badge" wx:if="{{item.badge}}">{{item.badge}}</view>
      <text class="menu-arrow">â€º</text>
    </view>
  </view>
</view>
